"use strict";(self.webpackChunk_dagster_io_dagit_app=self.webpackChunk_dagster_io_dagit_app||[]).push([[4],{77523:function(e,n,r){r.d(n,{C:function(){return h}});var t=r(19065),i=r(8358),o=r(32030),s=r(75453),a=r(75497),l=r(325),c=r(93141),d=r(76336),u=r(32289),h=function(){var e=l.useContext(d.C5),n=e.allRepos,r=e.visibleRepos,h=e.toggleVisible,p=l.useState(!1),f=(0,t.Z)(p,2),x=f[0],m=f[1];return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(i.Vq,{canOutsideClickClose:!0,canEscapeKeyClose:!0,isOpen:x,style:{width:"auto"},onClose:function(){return m(!1)},children:[(0,u.jsx)(i.fK,{icon:"repo",label:"Filter code locations"}),(0,u.jsx)(c.e,{options:n,onBrowse:function(){return m(!1)},onToggle:h,selected:r}),(0,u.jsx)(i.cN,{children:(0,u.jsx)(o.x,{padding:{top:8},children:(0,u.jsx)(s.zx,{intent:"none",onClick:function(){return m(!1)},children:"Done"})})})]}),(0,u.jsx)(s.zx,{intent:"none",icon:(0,u.jsx)(a.JO,{name:"folder"}),rightIcon:(0,u.jsx)(a.JO,{name:"expand_more"}),onClick:function(){return m(!0)},children:"".concat(r.length," of ").concat(n.length)})]})}},6556:function(e,n,r){r.r(n),r.d(n,{OverviewRoot:function(){return Jn},default:function(){return Kn}});var t,i,o,s=r(325),a=r(27601),l=r(99500),c=r(95764),d=r(73701),u=r(3159),h=r(30804),p=r(31112),f=r(12745),x=r(32030),m=r(89646),j=r(47387),g=r(79082),v=r(12436),y=r(19102),w=r(78093),b=r(82348),k=r(31269),C=r(81745),S=r(37286),E=r(32289),T=function(e){var n=e.refreshState,r=e.tab,t=(0,C.gV)().flagSidebarResources;return(0,E.jsxs)(x.x,{flex:{direction:"row",justifyContent:"space-between",alignItems:"flex-end"},children:[(0,E.jsxs)(k.mQ,{selectedTabId:r,children:[(0,E.jsx)(S.f,{id:"timeline",title:"Timeline",to:"/overview/timeline"}),(0,E.jsx)(S.f,{id:"jobs",title:"Jobs",to:"/overview/jobs"}),(0,E.jsx)(S.f,{id:"schedules",title:"Schedules",to:"/overview/schedules"}),(0,E.jsx)(S.f,{id:"sensors",title:"Sensors",to:"/overview/sensors"}),t&&(0,E.jsx)(S.f,{id:"resources",title:"Resources",to:"/overview/resources"}),(0,E.jsx)(S.f,{id:"backfills",title:"Backfills",to:"/overview/backfills"})]}),n?(0,E.jsx)(x.x,{padding:{bottom:8},children:(0,E.jsx)(y.xi,{refreshState:n})}):null]})},A=r(79253),O=r(77892),N=r(50741),I=r(76450),L=r(78042),P=function(){(0,w.Px)(),(0,b.j)("Overview | Backfills");var e=(0,d.a)(R),n=(0,O.l)({query:F,variables:{},pageSize:10,nextCursorForResult:function(e){var n;return"PartitionBackfills"===e.partitionBackfillsOrError.__typename?null===(n=e.partitionBackfillsOrError.results[9])||void 0===n?void 0:n.backfillId:void 0},getResultArray:function(e){return"PartitionBackfills"===(null===e||void 0===e?void 0:e.partitionBackfillsOrError.__typename)?e.partitionBackfillsOrError.results:[]}}),r=n.queryResult,t=n.paginationProps,i=(0,y.C4)(r,y.dT);return(0,E.jsxs)(h.T,{children:[(0,E.jsx)(p.m,{title:(0,E.jsx)(f.X6,{children:"Overview"}),tabs:(0,E.jsx)(T,{tab:"backfills",refreshState:i})}),(0,E.jsx)(N.g,{queryResult:r,allowStaleData:!0,children:function(n){var i,o=n.partitionBackfillsOrError;if("PythonError"===o.__typename)return(0,E.jsx)(v.T,{error:o});if(!o.results.length)return(0,E.jsx)(x.x,{padding:{vertical:64},children:(0,E.jsx)(m.t,{icon:"no-results",title:"No backfills found",description:(0,E.jsx)("p",{children:"This instance does not have any backfill jobs."})})});var s=((null===(i=e.data)||void 0===i?void 0:i.instance.daemonHealth.allDaemonStatuses)||[]).filter((function(e){return"BACKFILL"===e.daemonType})).map((function(e){return e.required&&e.healthy})),a=s.length&&s.every((function(e){return e}));return(0,E.jsxs)("div",{children:[a?null:(0,E.jsx)(x.x,{padding:{horizontal:24,vertical:16},children:(0,E.jsx)(A.B1,{})}),(0,E.jsx)(I.G,{backfills:o.results.slice(0,10),refetch:r.refetch}),o.results.length>0?(0,E.jsx)("div",{style:{marginTop:"16px"},children:(0,E.jsx)(j.b$,(0,c.Z)({},t))}):null]})}})]})},R=(0,u.Ps)(t||(t=(0,l.Z)(["\n  query InstanceHealthForBackfillsQuery {\n    instance {\n      ...InstanceHealthFragment\n    }\n  }\n\n  ","\n"])),L.O),F=(0,u.Ps)(i||(i=(0,l.Z)(["\n  query InstanceBackfillsQuery($cursor: String, $limit: Int) {\n    partitionBackfillsOrError(cursor: $cursor, limit: $limit) {\n      ... on PartitionBackfills {\n        results {\n          backfillId\n          status\n          isValidSerialization\n          numPartitions\n          timestamp\n          partitionSetName\n          partitionSet {\n            id\n            name\n            mode\n            pipelineName\n            repositoryOrigin {\n              id\n              repositoryName\n              repositoryLocationName\n            }\n          }\n          error {\n            ...PythonErrorFragment\n          }\n\n          ...BackfillTableFragment\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"])),g.B,I.b),z=r(19065),Z=r(922),_=r(34595),U=r(55113),B=r(7838),D=r(54268),V=r(60652),q=r(8358),W=r(75453),$=r(13008),M=r.n($),G=r(55386),J=r.n(G),K=r(93975),Q=r.n(K),H=r(74549),X=r(69305),Y=r(45302),ee=r(1520),ne=r(25298);M().extend(J()),M().extend(Q());var re=function(){var e=(0,a.UO)().backfillId;(0,w.Px)(),(0,b.j)("Backfill | ".concat(e));var n=(0,d.a)(me,{variables:{backfillId:e}}),r=n.data,t=null===r||void 0===r?void 0:r.partitionBackfillOrError,i=!0;return t&&"PartitionBackfill"===t.__typename&&(i=t.status===X.Jv3.REQUESTED),(0,y.C4)(n,5e3,i),(0,E.jsxs)(h.T,{children:[(0,E.jsx)(p.m,{title:(0,E.jsxs)("div",{style:{fontSize:"18px"},children:[(0,E.jsx)(H.rU,{to:"/overview/backfills",style:{color:B.w.Gray700},children:"Backfills"})," / ",e]})}),function(){var n,i,o;if(!t||!r)return(0,E.jsx)(x.x,{padding:64,"data-testid":(0,ee.N)("page-loading-indicator"),children:(0,E.jsx)(_.$,{purpose:"page"})});if("PythonError"===t.__typename)return(0,E.jsx)(v.T,{error:t});function s(n){var r=[{token:"tag",value:"dagster/backfill=".concat(e)}];switch(n){case"requested":r.push({token:"status",value:X.VOA.STARTED},{token:"status",value:X.VOA.QUEUED},{token:"status",value:X.VOA.STARTING});break;case"complete":r.push({token:"status",value:X.VOA.SUCCESS});break;case"failed":r.push({token:"status",value:X.VOA.FAILURE}),r.push({token:"status",value:X.VOA.CANCELED})}return(0,Y.it)(r)}return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)(x.x,{padding:24,flex:{direction:"row",justifyContent:"space-between",wrap:"nowrap",alignItems:"center"},children:[(0,E.jsx)(te,{label:"Created",detail:"Mar 22, 5:00 PM"}),(0,E.jsx)(te,{label:"Duration",detail:(0,E.jsx)(xe,{start:1e3*t.timestamp,end:t.endTimestamp?1e3*t.endTimestamp:null})}),(0,E.jsx)(te,{label:"Partition Selection",detail:(0,E.jsx)(je,{numPartitions:t.numPartitions||0,rootAssetTargetedPartitions:null===(n=t.assetBackfillData)||void 0===n?void 0:n.rootAssetTargetedPartitions,rootAssetTargetedRanges:null===(i=t.assetBackfillData)||void 0===i?void 0:i.rootAssetTargetedRanges})}),(0,E.jsx)(te,{label:"Status",detail:(0,E.jsx)(ie,{status:t.status})})]}),(0,E.jsxs)(U.i,{children:[(0,E.jsx)("thead",{children:(0,E.jsxs)("tr",{children:[(0,E.jsx)("th",{style:{width:"50%"},children:"Asset name"}),(0,E.jsx)("th",{children:"Partitions targeted"}),(0,E.jsx)("th",{children:"Requested"}),(0,E.jsx)("th",{children:"Complete"}),(0,E.jsx)("th",{children:"Failed"})]})}),(0,E.jsx)("tbody",{children:null===(o=t.assetBackfillData)||void 0===o?void 0:o.assetPartitionsStatusCounts.map((function(e){return(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{children:(0,E.jsxs)(x.x,{flex:{direction:"row",justifyContent:"space-between"},children:[(0,E.jsx)("div",{children:e.assetKey.path.join("/")}),(0,E.jsx)("div",{children:(0,E.jsx)(oe,{targeted:e.numPartitionsTargeted,requested:e.numPartitionsRequested,completed:e.numPartitionsCompleted,failed:e.numPartitionsFailed})})]})}),(0,E.jsx)("td",{children:(0,E.jsx)("a",{href:s("targeted"),children:e.numPartitionsTargeted})}),(0,E.jsx)("td",{children:(0,E.jsxs)(x.x,{flex:{direction:"row",justifyContent:"space-between"},children:[(0,E.jsx)("div",{children:e.numPartitionsRequested}),(0,E.jsx)("div",{children:e.numPartitionsRequested?(0,E.jsx)("a",{href:s("requested"),children:"View Runs"}):null})]})}),(0,E.jsx)("td",{children:(0,E.jsxs)(x.x,{flex:{direction:"row",justifyContent:"space-between"},children:[(0,E.jsx)("div",{children:e.numPartitionsCompleted}),(0,E.jsx)("div",{children:e.numPartitionsCompleted?(0,E.jsx)("a",{href:s("complete"),children:"View Runs"}):null})]})}),(0,E.jsx)("td",{children:(0,E.jsxs)(x.x,{flex:{direction:"row",justifyContent:"space-between"},children:[(0,E.jsx)("div",{children:e.numPartitionsFailed}),(0,E.jsx)("div",{children:e.numPartitionsFailed?(0,E.jsx)("a",{href:s("failed"),children:"View Runs"}):null})]})})]},e.assetKey.path.join("/"))}))})]})]})}()]})},te=function(e){var n=e.label,r=e.detail;return(0,E.jsxs)(x.x,{flex:{direction:"column",gap:4},style:{minWidth:"280px"},children:[(0,E.jsx)(fe,{children:n}),(0,E.jsx)("div",{children:r})]})},ie=function(e){switch(e.status){case X.Jv3.CANCELED:return(0,E.jsx)(D.V,{intent:"warning",children:"Canceled"});case X.Jv3.COMPLETED:return(0,E.jsx)(D.V,{intent:"success",children:"Complete"});case X.Jv3.FAILED:return(0,E.jsx)(D.V,{intent:"danger",children:"Failed"});case X.Jv3.REQUESTED:return(0,E.jsx)(D.V,{intent:"primary",icon:"spinner",children:"In Progress"});default:return(0,E.jsx)(D.V,{intent:"warning",children:"Incomplete"})}};function oe(e){var n=e.targeted,r=e.requested,t=e.completed,i=e.failed;return(0,E.jsxs)("div",{style:{borderRadius:"8px",backgroundColor:B.w.Gray100,display:"grid",gridTemplateColumns:"".concat(100*t/n,"% ").concat(100*i/n,"% ").concat(100*r/n,"%"),gridTemplateRows:"100%",height:"12px",width:"200px",overflow:"hidden"},children:[(0,E.jsx)("div",{style:{background:B.w.Green500}}),(0,E.jsx)("div",{style:{background:B.w.Red500}}),(0,E.jsx)("div",{style:{background:B.w.Blue200}})]})}var se,ae,le,ce,de,ue,he,pe,fe=Z.ZP.div.withConfig({displayName:"BackfillPage__Label",componentId:"sc-19sdlda-0"})(["color:",";font-size:12px;line-height:16px;"],B.w.Gray700),xe=function(e){var n=e.start,r=e.end,t=s.useReducer((function(e,n){return e+1}),0),i=(0,z.Z)(t,2),o=(i[0],i[1]);s.useEffect((function(){if(!r){var e=setInterval(o,6e4);return function(){return clearInterval(e)}}}),[n,r]);var a=r?r-n:Date.now()-n,l=M().duration(a).humanize(!1);return(0,E.jsx)("span",{children:l})},me=(0,u.Ps)(o||(o=(0,l.Z)(["\n  query BackfillStatusesByAsset($backfillId: String!) {\n    partitionBackfillOrError(backfillId: $backfillId) {\n      ...PartitionBackfillFragment\n      ...PythonErrorFragment\n    }\n  }\n\n  fragment PartitionBackfillFragment on PartitionBackfill {\n    status\n    timestamp\n    endTimestamp\n    numPartitions\n    assetBackfillData {\n      rootAssetTargetedRanges {\n        start\n        end\n      }\n      rootAssetTargetedPartitions\n      assetPartitionsStatusCounts {\n        assetKey {\n          path\n        }\n        numPartitionsTargeted\n        numPartitionsRequested\n        numPartitionsCompleted\n        numPartitionsFailed\n      }\n    }\n  }\n  ","\n"])),g.B),je=function(e){var n,r,t=e.numPartitions,i=e.rootAssetTargetedRanges,o=e.rootAssetTargetedPartitions,a=s.useState(!1),l=(0,z.Z)(a,2),c=l[0],d=l[1];if(o)o.length>3?(n=(0,E.jsx)("div",{children:o.map((function(e){return(0,E.jsx)("div",{children:e},e)}))}),r=(0,E.jsxs)(V.Z,{onClick:function(){d(!0)},children:[ne.V.format(t)," partitions"]})):r=(0,E.jsx)(x.x,{flex:{direction:"row",gap:8,wrap:"wrap"},children:o.map((function(e){return(0,E.jsx)("div",{children:e},e)}))});else if(1===(null===i||void 0===i?void 0:i.length)){var u=i[0],h=u.start,p=u.end;r=(0,E.jsxs)("div",{children:[h," - ",p]})}else r=(0,E.jsxs)(V.Z,{onClick:function(){d(!0)},children:[ne.V.format(t)," partitions"]}),n=(0,E.jsx)(x.x,{flex:{direction:"column",gap:8},children:null===i||void 0===i?void 0:i.map((function(e){return(0,E.jsxs)("div",{children:[e.start," - ",e.end]},"".concat(e.start,":").concat(e.end))}))});return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("div",{children:r}),(0,E.jsxs)(q.Vq,{isOpen:!!n&&c,title:"Partition selection",children:[(0,E.jsx)(q.a7,{children:n}),(0,E.jsx)(q.cN,{topBorder:!0,children:(0,E.jsx)(W.zx,{onClick:function(){return d(!1)},children:"Close"})})]})]})},ge=r(47427),ve=r(88863),ye=r(39061),we=r(44198),be=r(77523),ke=r(76336),Ce=r(37099),Se=r(33902),Ee=r(11831),Te=r(519),Ae=r(3580),Oe=r(65864),Ne=r(71824),Ie=r(82426),Le=r(16279),Pe=r(13688),Re=function(e){var n=e.repos,r=s.useRef(null),t=s.useMemo((function(){return n.map((function(e){var n=e.repoAddress;return(0,Se.Uz)(n)}))}),[n]),i=(0,Ne.N)(Pe.y,t),o=i.expandedKeys,a=i.onToggle,l=i.onToggleAll,c=s.useMemo((function(){var e=[];return n.forEach((function(n){var r=n.repoAddress,t=n.jobs;e.push({type:"header",repoAddress:r,jobCount:t.length});var i=(0,Se.Uz)(r);o.includes(i)&&t.forEach((function(n){var t=n.isJob,i=n.name;e.push({type:"job",repoAddress:r,isJob:t,name:i})}))})),e}),[n,o]),d=(0,Oe.w)(n.map((function(e){return e.repoAddress.name}))),u=(0,Te.useVirtualizer)({count:c.length,getScrollElement:function(){return r.current},estimateSize:function(e){var n=c[e];return"header"===(null===n||void 0===n?void 0:n.type)?32:64},overscan:10}),h=u.getTotalSize(),p=u.getVirtualItems();return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(Ie.I,{}),(0,E.jsx)("div",{style:{overflow:"hidden"},children:(0,E.jsx)(Ae.W2,{ref:r,children:(0,E.jsx)(Ae.Nh,{$totalHeight:h,children:p.map((function(e){var n=e.index,r=e.key,t=e.size,i=e.start,s=c[n];return"header"===s.type?(0,E.jsx)(Le.vG,{repoAddress:s.repoAddress,height:t,start:i,onToggle:a,onToggleAll:l,expanded:o.includes((0,Se.Uz)(s.repoAddress)),showLocation:d.has(s.repoAddress.name),rightElement:(0,E.jsx)(Ee.u,{content:1===s.jobCount?"1 job":"".concat(s.jobCount," jobs"),placement:"top",children:(0,E.jsx)(D.V,{children:s.jobCount})})},r):(0,E.jsx)(Ie.b,{name:s.name,isJob:s.isJob,repoAddress:s.repoAddress,height:t,start:i},r)}))})})})]})},Fe=r(59019),ze=function(e){return(0,Fe.Z)(e).sort((function(e,n){var r=(0,Se.Uz)(e.repoAddress),t=(0,Se.Uz)(n.repoAddress);return r.localeCompare(t)}))},Ze=function(e){return new Set(e.map((function(e){return(0,Se.Uz)((0,Ce.kQ)(e.repository.name,e.repositoryLocation.name))})))},_e=function(){(0,w.Px)(),(0,b.j)("Overview | Jobs");var e=s.useContext(ke.C5),n=e.allRepos,r=e.visibleRepos,t=(0,we.q)({queryKey:"search",defaults:{search:""}}),i=(0,z.Z)(t,2),o=i[0],a=i[1],l=n.length,c=(0,d.a)(Be,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),u=c.data,h=c.loading,j=(0,y.C4)(c,y.dT),g=s.useMemo((function(){var e=Ze(r);return Ue(u).filter((function(n){var r=n.repoAddress;return e.has((0,Se.Uz)(r))}))}),[u,r]),v=o.trim().toLocaleLowerCase(),k=v.length>0,C=s.useMemo((function(){var e=v.toLocaleLowerCase();return g.map((function(n){return{repoAddress:n.repoAddress,jobs:n.jobs.filter((function(n){return n.name.toLocaleLowerCase().includes(e)}))}})).filter((function(e){return e.jobs.length>0}))}),[g,v]);return(0,E.jsxs)(x.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,E.jsx)(p.m,{title:(0,E.jsx)(f.X6,{children:"Overview"}),tabs:(0,E.jsx)(T,{tab:"jobs",refreshState:j})}),(0,E.jsxs)(x.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[l>1?(0,E.jsx)(be.C,{}):null,(0,E.jsx)(ve.oi,{icon:"search",value:o,onChange:function(e){return a(e.target.value)},placeholder:"Filter by job name\u2026",style:{width:"340px"}})]}),h&&!l?(0,E.jsx)(x.x,{padding:64,children:(0,E.jsx)(_.$,{purpose:"page"})}):function(){if(h&&!u)return(0,E.jsx)(x.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,E.jsxs)(x.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,E.jsx)(_.$,{purpose:"body-text"}),(0,E.jsx)("div",{style:{color:B.w.Gray600},children:"Loading jobs\u2026"})]})});var e=n.length>r.length;return C.length?(0,E.jsx)(Re,{repos:C}):k?(0,E.jsx)(x.x,{padding:{top:20},children:(0,E.jsx)(m.t,{icon:"search",title:"No matching jobs",description:e?(0,E.jsxs)("div",{children:["No jobs matching ",(0,E.jsx)("strong",{children:o})," were found in the selected code locations"]}):(0,E.jsxs)("div",{children:["No jobs matching ",(0,E.jsx)("strong",{children:o})," were found in your definitions"]})})}):(0,E.jsx)(x.x,{padding:{top:20},children:(0,E.jsx)(m.t,{icon:"search",title:"No jobs",description:e?"No jobs were found in the selected code locations":"No jobs were found in your definitions"})})}()]})},Ue=function(e){if("Workspace"!==(null===e||void 0===e?void 0:e.workspaceOrError.__typename))return[];var n,r=e.workspaceOrError.locationEntries.map((function(e){return e.locationOrLoadError})),t=[],i=(0,ge.Z)(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;if("RepositoryLocation"===(null===o||void 0===o?void 0:o.__typename)){var s,a=(0,ge.Z)(o.repositories);try{for(a.s();!(s=a.n()).done;){var l=s.value,c=l.name,d=l.pipelines,u=(0,Ce.kQ)(c,o.name),h=d.filter((function(e){var n=e.name;return!(0,ye.pv)(n)})).map((function(e){return{isJob:e.isJob,name:e.name}}));h.length>0&&t.push({repoAddress:u,jobs:h})}}catch(p){a.e(p)}finally{a.f()}}}}catch(p){i.e(p)}finally{i.f()}return ze(t)},Be=(0,u.Ps)(se||(se=(0,l.Z)(["\n  query OverviewJobsQuery {\n    workspaceOrError {\n      ... on Workspace {\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                pipelines {\n                  id\n                  name\n                  isJob\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n"])),g.B),De=r(85827),Ve=r(87478),qe=function(e){var n=e.repos,r=s.useRef(null),t=s.useMemo((function(){return n.map((function(e){var n=e.repoAddress;return(0,Se.Uz)(n)}))}),[n]),i=(0,Ne.N)(Pe.y,t),o=i.expandedKeys,a=i.onToggle,l=i.onToggleAll,d=s.useMemo((function(){var e=[];return n.forEach((function(n){var r=n.repoAddress,t=n.resources;e.push({type:"header",repoAddress:r,resourceCount:t.length});var i=(0,Se.Uz)(r);o.includes(i)&&t.forEach((function(n){e.push((0,c.Z)({type:"resource",repoAddress:r},n))}))})),e}),[n,o]),u=(0,Oe.w)(n.map((function(e){return e.repoAddress.name}))),h=(0,Te.useVirtualizer)({count:d.length,getScrollElement:function(){return r.current},estimateSize:function(e){var n=d[e];return"header"===(null===n||void 0===n?void 0:n.type)?32:64},overscan:10}),p=h.getTotalSize(),f=h.getVirtualItems();return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(Ve.f,{}),(0,E.jsx)("div",{style:{overflow:"hidden"},children:(0,E.jsx)(Ae.W2,{ref:r,children:(0,E.jsx)(Ae.Nh,{$totalHeight:p,children:f.map((function(e){var n=e.index,r=e.key,t=e.size,i=e.start,s=d[n];return"header"===s.type?(0,E.jsx)(Le.vG,{repoAddress:s.repoAddress,height:t,start:i,onToggle:a,onToggleAll:l,expanded:o.includes((0,Se.Uz)(s.repoAddress)),showLocation:u.has(s.repoAddress.name),rightElement:(0,E.jsx)(Ee.u,{content:1===s.resourceCount?"1 resource":"".concat(s.resourceCount," resources"),placement:"top",children:(0,E.jsx)(D.V,{children:s.resourceCount})})},r):(0,E.jsx)(Ve.K,(0,c.Z)({height:t,start:i},s),r)}))})})})]})},We=function(){(0,w.Px)(),(0,b.j)("Overview | Resources");var e=s.useContext(ke.C5),n=e.allRepos,r=e.visibleRepos,t=(0,we.q)({queryKey:"search",defaults:{search:""}}),i=(0,z.Z)(t,2),o=i[0],a=i[1],l=n.length,c=(0,d.a)(Me,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),u=c.data,h=c.loading,j=(0,y.C4)(c,y.dT),g=s.useMemo((function(){var e=Ze(r);return $e(u).filter((function(n){var r=n.repoAddress;return e.has((0,Se.Uz)(r))}))}),[u,r]),v=o.trim().toLocaleLowerCase(),k=v.length>0,C=s.useMemo((function(){var e=v.toLocaleLowerCase();return g.map((function(n){return{repoAddress:n.repoAddress,resources:n.resources.filter((function(n){return n.name.toLocaleLowerCase().includes(e)}))}})).filter((function(e){return e.resources.length>0}))}),[g,v]);return(0,E.jsxs)(x.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,E.jsx)(p.m,{title:(0,E.jsx)(f.X6,{children:"Overview"}),tabs:(0,E.jsx)(T,{tab:"resources",refreshState:j})}),(0,E.jsxs)(x.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[l>1?(0,E.jsx)(be.C,{}):null,(0,E.jsx)(ve.oi,{icon:"search",value:o,onChange:function(e){return a(e.target.value)},placeholder:"Filter by resource name\u2026",style:{width:"340px"}})]}),h&&!l?(0,E.jsx)(x.x,{padding:64,children:(0,E.jsx)(_.$,{purpose:"page"})}):function(){if(h&&!u)return(0,E.jsx)(x.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,E.jsxs)(x.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,E.jsx)(_.$,{purpose:"body-text"}),(0,E.jsx)("div",{style:{color:B.w.Gray600},children:"Loading resources\u2026"})]})});var e=n.length>r.length;return C.length?(0,E.jsx)(qe,{repos:C}):k?(0,E.jsx)(x.x,{padding:{top:20},children:(0,E.jsx)(m.t,{icon:"search",title:"No matching resources",description:e?(0,E.jsxs)("div",{children:["No resources matching ",(0,E.jsx)("strong",{children:o})," were found in the selected code locations"]}):(0,E.jsxs)("div",{children:["No resources matching ",(0,E.jsx)("strong",{children:o})," were found in your definitions"]})})}):(0,E.jsx)(x.x,{padding:{top:20},children:(0,E.jsx)(m.t,{icon:"search",title:"No resources",description:e?"No resources were found in the selected code locations":"No resources were found in your definitions"})})}()]})},$e=function(e){if("Workspace"!==(null===e||void 0===e?void 0:e.workspaceOrError.__typename))return[];var n,r=e.workspaceOrError.locationEntries.map((function(e){return e.locationOrLoadError})),t=[],i=(0,ge.Z)(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;if("RepositoryLocation"===(null===o||void 0===o?void 0:o.__typename)){var s,a=(0,ge.Z)(o.repositories);try{for(a.s();!(s=a.n()).done;){var l=s.value,c=l.name,d=l.allTopLevelResourceDetails,u=(0,Ce.kQ)(c,o.name);d.length>0&&t.push({repoAddress:u,resources:d})}}catch(h){a.e(h)}finally{a.f()}}}}catch(h){i.e(h)}finally{i.f()}return ze(t)},Me=(0,u.Ps)(ae||(ae=(0,l.Z)(["\n  query OverviewResourcesQuery {\n    workspaceOrError {\n      ... on Workspace {\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                allTopLevelResourceDetails {\n                  ...ResourceEntryFragment\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"])),g.B,De.L),Ge=r(60736),Je=r(45352),Ke=r(85358),Qe=r(95550),He=r.n(Qe),Xe=r(49148),Ye=r(50346),en=r(6466),nn=r(79540),rn=r(63579),tn=r(73565),on=r(36243),sn=r(88161),an=r(2097),ln=r(62997),cn=function(e){var n=e.sensorStates,r=e.showSubheading,t=void 0===r||r;return n.length?(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)(x.x,{padding:{vertical:16,horizontal:20},children:[t?(0,E.jsx)(f.pm,{children:"Unloadable sensors"}):null,(0,E.jsx)(un,{})]}),(0,E.jsxs)(U.i,{children:[(0,E.jsx)("thead",{children:(0,E.jsxs)("tr",{children:[(0,E.jsx)("th",{style:{maxWidth:"60px"}}),(0,E.jsx)("th",{children:"Sensor name"}),(0,E.jsx)("th",{style:{width:"100px"},children:"Last tick"}),(0,E.jsx)("th",{children:"Last run"})]})}),(0,E.jsx)("tbody",{children:n.map((function(e){return(0,E.jsx)(pn,{sensorState:e},e.id)}))})]})]}):null},dn=function(e){var n=e.scheduleStates,r=e.showSubheading,t=void 0===r||r;return n.length?(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)(x.x,{padding:{vertical:16,horizontal:20},children:[t?(0,E.jsx)(f.pm,{children:"Unloadable schedules"}):null,(0,E.jsx)(hn,{})]}),(0,E.jsxs)(U.i,{children:[(0,E.jsx)("thead",{children:(0,E.jsxs)("tr",{children:[(0,E.jsx)("th",{style:{maxWidth:"60px"}}),(0,E.jsx)("th",{children:"Schedule name"}),(0,E.jsx)("th",{style:{width:"150px"},children:"Schedule"}),(0,E.jsx)("th",{style:{width:"100px"},children:"Last tick"}),(0,E.jsx)("th",{children:"Last run"}),(0,E.jsx)("th",{children:"Partition set status"})]})}),(0,E.jsx)("tbody",{children:n.map((function(e){return(0,E.jsx)(fn,{scheduleState:e},e.id)}))})]})]}):null},un=function(){return(0,E.jsx)(Ge.b,{intent:"warning",title:(0,E.jsxs)("div",{children:["Note: You can turn off any of the following sensors, but you cannot turn them back on."," "]}),description:(0,E.jsx)("div",{children:"The following sensors were previously started but now cannot be loaded. They may be part of a different workspace or from a sensor or code location that no longer exists in code. You can turn them off, but you cannot turn them back on since they can\u2019t be loaded."})})},hn=function(){return(0,E.jsx)(Ge.b,{intent:"warning",title:(0,E.jsx)("div",{children:"Note: You can turn off any of the following schedules, but you cannot turn them back on."}),description:(0,E.jsx)("div",{children:"The following schedules were previously started but now cannot be loaded. They may be part of a different workspace or from a schedule or code location that no longer exists in code. You can turn them off, but you cannot turn them back on since they can\u2019t be loaded."})})},pn=function(e){var n=e.sensorState,r=n.id,t=n.selectorId,i=n.name,o=n.status,s=n.ticks,a=n.hasStopPermission,l=(0,Xe.D)(sn.Xu,{onCompleted:sn.oI}),c=(0,z.Z)(l,2),d=c[0],u=c[1].loading,h=(0,nn.p)(),p=function(){var e=(0,Ke.Z)(He().mark((function e(){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o!==X.ynu.RUNNING){e.next=4;break}return e.next=3,h({title:"Are you sure you want to turn off this sensor?",description:"The definition for this sensor is not available. If you turn it off, you will not be able to turn it back on from the currently loaded workspace."});case 3:d({variables:{jobOriginId:r,jobSelectorId:t}});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=o===X.ynu.RUNNING&&!a,x=s.length?s[0]:null;return(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{style:{width:60},children:function(){var e=(0,E.jsx)(Ye.X,{format:"switch",disabled:u||o===X.ynu.STOPPED||f,checked:o===X.ynu.RUNNING,onChange:p});return f?(0,E.jsx)(Ee.u,{content:rn.Qr,children:e}):e}()}),(0,E.jsxs)("td",{children:[(0,E.jsx)(en.Z,{direction:"row",spacing:8,alignItems:"center",children:i}),(0,E.jsx)(an.Y,{instigatorState:n})]}),(0,E.jsx)("td",{children:x?(0,E.jsx)(ln.TW,{tick:x,instigationType:X._5b.SENSOR}):(0,E.jsx)("span",{style:{color:B.w.Gray300},children:"None"})}),(0,E.jsx)("td",{children:(0,E.jsx)("div",{style:{display:"flex"},children:(0,E.jsx)(Je.UD,{instigationState:n})})})]},i)},fn=function(e){var n=e.scheduleState,r=(0,Xe.D)(tn.d0,{onCompleted:tn.JH}),t=(0,z.Z)(r,2),i=t[0],o=t[1].loading,s=(0,nn.p)(),a=n.id,l=n.selectorId,c=n.name,d=n.ticks,u=n.status,h=n.typeSpecificData,p=d.length>0?d[0]:null,f=h&&"ScheduleData"===h.__typename?h.cronSchedule:null,x=function(){var e=(0,Ke.Z)(He().mark((function e(){return He().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u!==X.ynu.RUNNING){e.next=4;break}return e.next=3,s({title:"Are you sure you want to stop this schedule?",description:"The definition for this schedule is not available. If you turn it off, you will not be able to turn it back on from the currently loaded workspace."});case 3:i({variables:{scheduleOriginId:a,scheduleSelectorId:l}});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=u===X.ynu.RUNNING&&!n.hasStopPermission;return(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{style:{width:60},children:function(){var e=(0,E.jsx)(Ye.X,{format:"switch",checked:u===X.ynu.RUNNING,disabled:u!==X.ynu.RUNNING||o||m,onChange:x});return m?(0,E.jsx)(Ee.u,{content:rn.Qr,children:e}):e}()}),(0,E.jsxs)("td",{children:[(0,E.jsx)(en.Z,{direction:"row",spacing:8,alignItems:"center",children:(0,E.jsx)("div",{children:c})}),(0,E.jsx)(an.Y,{instigatorState:n})]}),(0,E.jsx)("td",{style:{maxWidth:150},children:(0,E.jsx)("div",{style:{position:"relative",width:"100%",whiteSpace:"pre-wrap",display:"block"},children:f?(0,E.jsx)(Ee.u,{position:"bottom",content:f,children:(0,on.A)(f)}):(0,E.jsx)("div",{children:"\u2014"})})}),(0,E.jsx)("td",{children:p?(0,E.jsx)(ln.TW,{tick:p,instigationType:X._5b.SCHEDULE}):null}),(0,E.jsx)("td",{children:(0,E.jsx)(Je.UD,{instigationState:n})}),(0,E.jsx)("td",{children:(0,E.jsx)("div",{style:{display:"flex"},children:"\u2014"})})]},c)},xn=r(89324),mn=r(17233),jn=function(e){var n=e.repos,r=s.useRef(null),t=s.useMemo((function(){return n.map((function(e){var n=e.repoAddress;return(0,Se.Uz)(n)}))}),[n]),i=(0,Ne.N)(Pe.y,t),o=i.expandedKeys,a=i.onToggle,l=i.onToggleAll,c=s.useMemo((function(){var e=[];return n.forEach((function(n){var r=n.repoAddress,t=n.schedules;e.push({type:"header",repoAddress:r,scheduleCount:t.length});var i=(0,Se.Uz)(r);o.includes(i)&&t.forEach((function(n){e.push({type:"schedule",repoAddress:r,name:n})}))})),e}),[n,o]),d=(0,Oe.w)(n.map((function(e){return e.repoAddress.name}))),u=(0,Te.useVirtualizer)({count:c.length,getScrollElement:function(){return r.current},estimateSize:function(e){var n=c[e];return"header"===(null===n||void 0===n?void 0:n.type)?32:64},overscan:10}),h=u.getTotalSize(),p=u.getVirtualItems();return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(mn.o,{}),(0,E.jsx)("div",{style:{overflow:"hidden"},children:(0,E.jsx)(Ae.W2,{ref:r,children:(0,E.jsx)(Ae.Nh,{$totalHeight:h,children:p.map((function(e){var n=e.index,r=e.key,t=e.size,i=e.start,s=c[n];return"header"===s.type?(0,E.jsx)(Le.vG,{repoAddress:s.repoAddress,height:t,start:i,onToggle:a,onToggleAll:l,expanded:o.includes((0,Se.Uz)(s.repoAddress)),showLocation:d.has(s.repoAddress.name),rightElement:(0,E.jsx)(Ee.u,{content:1===s.scheduleCount?"1 schedule":"".concat(s.scheduleCount," schedules"),placement:"top",children:(0,E.jsx)(D.V,{children:s.scheduleCount})})},r):(0,E.jsx)(mn.i,{name:s.name,repoAddress:s.repoAddress,height:t,start:i},r)}))})})})]})},gn=function(){(0,w.Px)(),(0,b.j)("Overview | Schedules");var e=s.useContext(ke.C5),n=e.allRepos,r=e.visibleRepos,t=n.length,i=(0,we.q)({queryKey:"search",defaults:{search:""}}),o=(0,z.Z)(i,2),a=o[0],l=o[1],c=(0,d.a)(bn,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),u=c.data,h=c.loading,j=(0,y.C4)(c,y.dT),g=s.useMemo((function(){var e=Ze(r);return wn(u).filter((function(n){var r=n.repoAddress;return e.has((0,Se.Uz)(r))}))}),[u,r]),v=a.trim().toLocaleLowerCase(),k=v.length>0,C=s.useMemo((function(){var e=v.toLocaleLowerCase();return g.map((function(n){return{repoAddress:n.repoAddress,schedules:n.schedules.filter((function(n){return n.toLocaleLowerCase().includes(e)}))}})).filter((function(e){return e.schedules.length>0}))}),[g,v]);return(0,E.jsxs)(x.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,E.jsx)(p.m,{title:(0,E.jsx)(f.X6,{children:"Overview"}),tabs:(0,E.jsx)(T,{tab:"schedules",refreshState:j})}),(0,E.jsxs)(x.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[t>0?(0,E.jsx)(be.C,{}):null,(0,E.jsx)(ve.oi,{icon:"search",value:a,onChange:function(e){return l(e.target.value)},placeholder:"Filter by schedule name\u2026",style:{width:"340px"}})]}),h&&!t?(0,E.jsx)(x.x,{padding:64,children:(0,E.jsx)(_.$,{purpose:"page"})}):(0,E.jsxs)(E.Fragment,{children:["InstigationStates"===(null===u||void 0===u?void 0:u.unloadableInstigationStatesOrError.__typename)?(0,E.jsx)(vn,{count:u.unloadableInstigationStatesOrError.results.length}):null,(0,E.jsx)(xn.K,{daemonHealth:null===u||void 0===u?void 0:u.instance.daemonHealth,padding:{vertical:16,horizontal:24},border:{side:"top",width:1,color:B.w.KeylineGray}}),function(){if(h&&!u)return(0,E.jsx)(x.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,E.jsxs)(x.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,E.jsx)(_.$,{purpose:"body-text"}),(0,E.jsx)("div",{style:{color:B.w.Gray600},children:"Loading schedules\u2026"})]})});var e=n.length>r.length;return C.length?(0,E.jsx)(jn,{repos:C}):k?(0,E.jsx)(x.x,{padding:{top:20},children:(0,E.jsx)(m.t,{icon:"search",title:"No matching schedules",description:e?(0,E.jsxs)("div",{children:["No schedules matching ",(0,E.jsx)("strong",{children:a})," were found in the selected code locations"]}):(0,E.jsxs)("div",{children:["No schedules matching ",(0,E.jsx)("strong",{children:a})," were found in your definitions"]})})}):(0,E.jsx)(x.x,{padding:{top:20},children:(0,E.jsx)(m.t,{icon:"search",title:"No schedules",description:e?"No schedules were found in the selected code locations":"No schedules were found in your definitions"})})}()]})]})},vn=function(e){var n=e.count,r=s.useState(!1),t=(0,z.Z)(r,2),i=t[0],o=t[1];if(!n)return null;var a=1===n?"1 unloadable schedule":"".concat(n," unloadable schedules");return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(x.x,{padding:{vertical:16,horizontal:24},border:{side:"top",width:1,color:B.w.KeylineGray},children:(0,E.jsx)(Ge.b,{intent:"warning",title:a,description:(0,E.jsxs)(x.x,{flex:{direction:"column",gap:12,alignItems:"flex-start"},children:[(0,E.jsx)("div",{children:"Schedules were previously started but now cannot be loaded. They may be part of a code locations that no longer exist. You can turn them off, but you cannot turn them back on."}),(0,E.jsx)(W.zx,{onClick:function(){return o(!0)},children:1===n?"View unloadable schedule":"View unloadable schedules"})]})})}),(0,E.jsxs)(q.Vq,{isOpen:i,title:"Unloadable schedules",style:{width:"90vw",maxWidth:"1200px"},children:[(0,E.jsx)(x.x,{padding:{bottom:8},children:(0,E.jsx)(yn,{})}),(0,E.jsx)(q.cN,{children:(0,E.jsx)(W.zx,{intent:"primary",onClick:function(){return o(!1)},children:"Done"})})]})]})},yn=function(){var e=(0,d.a)(kn).data;return e?"InstigationStates"===(null===e||void 0===e?void 0:e.unloadableInstigationStatesOrError.__typename)?(0,E.jsx)(dn,{scheduleStates:e.unloadableInstigationStatesOrError.results,showSubheading:!1}):(0,E.jsx)(v.T,{error:null===e||void 0===e?void 0:e.unloadableInstigationStatesOrError}):(0,E.jsx)(_.$,{purpose:"section"})},wn=function(e){if("Workspace"!==(null===e||void 0===e?void 0:e.workspaceOrError.__typename))return[];var n,r=e.workspaceOrError.locationEntries.map((function(e){return e.locationOrLoadError})),t=[],i=(0,ge.Z)(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;if("RepositoryLocation"===(null===o||void 0===o?void 0:o.__typename)){var s,a=(0,ge.Z)(o.repositories);try{for(a.s();!(s=a.n()).done;){var l=s.value,c=l.name,d=l.schedules,u=(0,Ce.kQ)(c,o.name),h=d.map((function(e){return e.name}));h.length>0&&t.push({repoAddress:u,schedules:h})}}catch(p){a.e(p)}finally{a.f()}}}}catch(p){i.e(p)}finally{i.f()}return ze(t)},bn=(0,u.Ps)(le||(le=(0,l.Z)(["\n  query OverviewSchedulesQuery {\n    workspaceOrError {\n      ... on Workspace {\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                schedules {\n                  id\n                  name\n                  description\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n    unloadableInstigationStatesOrError(instigationType: SCHEDULE) {\n      ... on InstigationStates {\n        results {\n          id\n        }\n      }\n    }\n    instance {\n      ...InstanceHealthFragment\n    }\n  }\n\n  ","\n  ","\n"])),g.B,L.O),kn=(0,u.Ps)(ce||(ce=(0,l.Z)(["\n  query UnloadableSchedulesQuery {\n    unloadableInstigationStatesOrError(instigationType: SCHEDULE) {\n      ... on InstigationStates {\n        results {\n          id\n          ...InstigationStateFragment\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"])),Je.ai,g.B),Cn=r(57466),Sn=r(19377),En=function(e){var n=e.repos,r=s.useRef(null),t=s.useMemo((function(){return n.map((function(e){var n=e.repoAddress;return(0,Se.Uz)(n)}))}),[n]),i=(0,Ne.N)(Pe.y,t),o=i.expandedKeys,a=i.onToggle,l=i.onToggleAll,c=s.useMemo((function(){var e=[];return n.forEach((function(n){var r=n.repoAddress,t=n.sensors;e.push({type:"header",repoAddress:r,sensorCount:t.length});var i=(0,Se.Uz)(r);o.includes(i)&&t.forEach((function(n){e.push({type:"sensor",repoAddress:r,name:n})}))})),e}),[n,o]),d=(0,Oe.w)(n.map((function(e){return e.repoAddress.name}))),u=(0,Te.useVirtualizer)({count:c.length,getScrollElement:function(){return r.current},estimateSize:function(e){var n=c[e];return"header"===(null===n||void 0===n?void 0:n.type)?32:64},overscan:10}),h=u.getTotalSize(),p=u.getVirtualItems();return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(Sn.K,{}),(0,E.jsx)("div",{style:{overflow:"hidden"},children:(0,E.jsx)(Ae.W2,{ref:r,children:(0,E.jsx)(Ae.Nh,{$totalHeight:h,children:p.map((function(e){var n=e.index,r=e.key,t=e.size,i=e.start,s=c[n];return"header"===s.type?(0,E.jsx)(Le.vG,{repoAddress:s.repoAddress,height:t,start:i,onToggle:a,onToggleAll:l,expanded:o.includes((0,Se.Uz)(s.repoAddress)),showLocation:d.has(s.repoAddress.name),rightElement:(0,E.jsx)(Ee.u,{content:1===s.sensorCount?"1 sensor":"".concat(s.sensorCount," sensors"),placement:"top",children:(0,E.jsx)(D.V,{children:s.sensorCount})})},r):(0,E.jsx)(Sn.R,{name:s.name,repoAddress:s.repoAddress,height:t,start:i},r)}))})})})]})},Tn=function(){(0,w.Px)(),(0,b.j)("Overview | Sensors");var e=s.useContext(ke.C5),n=e.allRepos,r=e.visibleRepos,t=n.length,i=(0,we.q)({queryKey:"search",defaults:{search:""}}),o=(0,z.Z)(i,2),a=o[0],l=o[1],c=(0,d.a)(In,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),u=c.data,h=c.loading,j=(0,y.C4)(c,y.dT),g=s.useMemo((function(){var e=Ze(r);return Nn(u).filter((function(n){var r=n.repoAddress;return e.has((0,Se.Uz)(r))}))}),[u,r]),v=a.trim().toLocaleLowerCase(),k=v.length>0,C=s.useMemo((function(){var e=v.toLocaleLowerCase();return g.map((function(n){return{repoAddress:n.repoAddress,sensors:n.sensors.filter((function(n){return n.toLocaleLowerCase().includes(e)}))}})).filter((function(e){return e.sensors.length>0}))}),[g,v]);return(0,E.jsxs)(x.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,E.jsx)(p.m,{title:(0,E.jsx)(f.X6,{children:"Overview"}),tabs:(0,E.jsx)(T,{tab:"sensors",refreshState:j})}),(0,E.jsxs)(x.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[t>0?(0,E.jsx)(be.C,{}):null,(0,E.jsx)(ve.oi,{icon:"search",value:a,onChange:function(e){return l(e.target.value)},placeholder:"Filter by sensor name\u2026",style:{width:"340px"}})]}),h&&!t?(0,E.jsx)(x.x,{padding:64,children:(0,E.jsx)(_.$,{purpose:"page"})}):(0,E.jsxs)(E.Fragment,{children:["InstigationStates"===(null===u||void 0===u?void 0:u.unloadableInstigationStatesOrError.__typename)?(0,E.jsx)(An,{count:u.unloadableInstigationStatesOrError.results.length}):null,(0,E.jsx)(Cn.F,{daemonHealth:null===u||void 0===u?void 0:u.instance.daemonHealth,padding:{vertical:16,horizontal:24},border:{side:"top",width:1,color:B.w.KeylineGray}}),function(){if(h&&!u)return(0,E.jsx)(x.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,E.jsxs)(x.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,E.jsx)(_.$,{purpose:"body-text"}),(0,E.jsx)("div",{style:{color:B.w.Gray600},children:"Loading sensors\u2026"})]})});var e=n.length>r.length;return C.length?(0,E.jsx)(En,{repos:C}):k?(0,E.jsx)(x.x,{padding:{top:20},children:(0,E.jsx)(m.t,{icon:"search",title:"No matching sensors",description:e?(0,E.jsxs)("div",{children:["No sensors matching ",(0,E.jsx)("strong",{children:a})," were found in the selected code locations"]}):(0,E.jsxs)("div",{children:["No sensors matching ",(0,E.jsx)("strong",{children:a})," were found in your definitions"]})})}):(0,E.jsx)(x.x,{padding:{top:20},children:(0,E.jsx)(m.t,{icon:"search",title:"No sensors",description:e?"No sensors were found in the selected code locations":"No sensors were found in your definitions"})})}()]})]})},An=function(e){var n=e.count,r=s.useState(!1),t=(0,z.Z)(r,2),i=t[0],o=t[1];if(!n)return null;var a=1===n?"1 unloadable sensor":"".concat(n," unloadable sensors");return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(x.x,{padding:{vertical:16,horizontal:24},border:{side:"top",width:1,color:B.w.KeylineGray},children:(0,E.jsx)(Ge.b,{intent:"warning",title:a,description:(0,E.jsxs)(x.x,{flex:{direction:"column",gap:12,alignItems:"flex-start"},children:[(0,E.jsx)("div",{children:"Sensors were previously started but now cannot be loaded. They may be part of a code location that no longer exists. You can turn them off, but you cannot turn them back on."}),(0,E.jsx)(W.zx,{onClick:function(){return o(!0)},children:1===n?"View unloadable sensor":"View unloadable sensors"})]})})}),(0,E.jsxs)(q.Vq,{isOpen:i,title:"Unloadable schedules",style:{width:"90vw",maxWidth:"1200px"},children:[(0,E.jsx)(x.x,{padding:{bottom:8},children:(0,E.jsx)(On,{})}),(0,E.jsx)(q.cN,{children:(0,E.jsx)(W.zx,{intent:"primary",onClick:function(){return o(!1)},children:"Done"})})]})]})},On=function(){var e=(0,d.a)(Ln).data;return e?"InstigationStates"===(null===e||void 0===e?void 0:e.unloadableInstigationStatesOrError.__typename)?(0,E.jsx)(cn,{sensorStates:e.unloadableInstigationStatesOrError.results,showSubheading:!1}):(0,E.jsx)(v.T,{error:null===e||void 0===e?void 0:e.unloadableInstigationStatesOrError}):(0,E.jsx)(_.$,{purpose:"section"})},Nn=function(e){if("Workspace"!==(null===e||void 0===e?void 0:e.workspaceOrError.__typename))return[];var n,r=e.workspaceOrError.locationEntries.map((function(e){return e.locationOrLoadError})),t=[],i=(0,ge.Z)(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;if("RepositoryLocation"===(null===o||void 0===o?void 0:o.__typename)){var s,a=(0,ge.Z)(o.repositories);try{for(a.s();!(s=a.n()).done;){var l=s.value,c=l.name,d=l.sensors,u=(0,Ce.kQ)(c,o.name),h=d.map((function(e){return e.name}));h.length>0&&t.push({repoAddress:u,sensors:h})}}catch(p){a.e(p)}finally{a.f()}}}}catch(p){i.e(p)}finally{i.f()}return ze(t)},In=(0,u.Ps)(de||(de=(0,l.Z)(["\n  query OverviewSensorsQuery {\n    workspaceOrError {\n      ... on Workspace {\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                sensors {\n                  id\n                  name\n                  description\n                  sensorType\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n    unloadableInstigationStatesOrError(instigationType: SENSOR) {\n      ... on InstigationStates {\n        results {\n          id\n        }\n      }\n    }\n    instance {\n      ...InstanceHealthFragment\n    }\n  }\n\n  ","\n  ","\n"])),g.B,L.O),Ln=(0,u.Ps)(ue||(ue=(0,l.Z)(["\n  query UnloadableSensorsQuery {\n    unloadableInstigationStatesOrError(instigationType: SENSOR) {\n      ... on InstigationStates {\n        results {\n          id\n          ...InstigationStateFragment\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"])),Je.ai,g.B),Pn=r(87011),Rn=r(32028),Fn=r(52453),zn=r(76314),Zn=r(16798),_n=(0,u.Ps)(he||(he=(0,l.Z)(["\n  fragment ScheduleFutureTicksFragment on Schedule {\n    id\n    executionTimezone\n    scheduleState {\n      id\n      status\n    }\n    futureTicks(cursor: $tickCursor, until: $ticksUntil) {\n      results {\n        timestamp\n      }\n    }\n  }\n"]))),Un=r(25582),Bn=r(34653),Dn=r(55752),Vn=r(18499),qn=function(e,n){return"".concat(n,"-").concat((0,Se.Uz)(e))},Wn=(0,u.Ps)(pe||(pe=(0,l.Z)(["\n  query RunTimelineQuery(\n    $inProgressFilter: RunsFilter!\n    $terminatedFilter: RunsFilter!\n    $tickCursor: Float\n    $ticksUntil: Float\n  ) {\n    unterminated: runsOrError(filter: $inProgressFilter) {\n      ... on Runs {\n        results {\n          id\n          pipelineName\n          repositoryOrigin {\n            id\n            repositoryName\n            repositoryLocationName\n          }\n          ...RunTimeFragment\n        }\n      }\n    }\n    terminated: runsOrError(filter: $terminatedFilter) {\n      ... on Runs {\n        results {\n          id\n          pipelineName\n          repositoryOrigin {\n            id\n            repositoryName\n            repositoryLocationName\n          }\n          ...RunTimeFragment\n        }\n      }\n    }\n    workspaceOrError {\n      ... on Workspace {\n        locationEntries {\n          id\n          name\n          loadStatus\n          displayMetadata {\n            key\n            value\n          }\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                pipelines {\n                  id\n                  name\n                  isJob\n                }\n                schedules {\n                  id\n                  name\n                  pipelineName\n                  scheduleState {\n                    id\n                    status\n                  }\n                  ...ScheduleFutureTicksFragment\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n\n  ","\n  ","\n"])),Dn.$X,_n),$n=36e5,Mn=function(e){switch(e){case"1":return $n;case"6":return 216e5;case"12":return 432e5;case"24":return 864e5}},Gn=function(){(0,w.Px)(),(0,b.j)("Overview | Timeline");var e=s.useContext(ke.C5),n=e.allRepos,r=e.visibleRepos,t=function(e){var n=s.useCallback((function(n){switch(n){case"1":case"6":case"12":case"24":return n;default:return e}}),[e]),r=(0,zn.U)("dagit.run-timeline-hour-window",n),t=(0,z.Z)(r,2),i=t[0],o=t[1],a=s.useCallback((function(n){o(n||e)}),[e,o]);return s.useMemo((function(){return[i,a]}),[i,a])}("12"),i=(0,z.Z)(t,2),o=i[0],a=i[1],l=s.useState((function(){return Date.now()})),u=(0,z.Z)(l,2),h=u[0],m=u[1],j=s.useState((function(){return 0})),g=(0,z.Z)(j,2),v=g[0],k=g[1],C=(0,we.q)({queryKey:"search",defaults:{search:""}}),S=(0,z.Z)(C,2),A=S[0],O=S[1];s.useEffect((function(){m(Date.now());var e=setInterval((function(){m(Date.now())}),6e4);return function(){clearInterval(e)}}),[o]);var N=s.useCallback((function(){k((function(e){return e-Mn(o)}))}),[o]),I=s.useCallback((function(){k((function(e){return e+Mn(o)}))}),[o]),L=s.useCallback((function(){k(0)}),[]),P=s.useMemo((function(){return[h-Number(o)*$n+v,h+36e5+v]}),[o,h,v]),R=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,z.Z)(e,2),t=r[0],i=r[1],o=t/1e3,a=i/1e3,l=(0,d.a)(Wn,{notifyOnNetworkStatusChange:!0,variables:{inProgressFilter:(0,c.Z)((0,c.Z)({},n),{},{statuses:[X.VOA.CANCELING,X.VOA.STARTED],createdBefore:a}),terminatedFilter:(0,c.Z)((0,c.Z)({},n),{},{statuses:Array.from(Bn.cv),createdBefore:a,updatedAfter:o}),tickCursor:o,ticksUntil:a}}),u=l.data,h=l.previousData,p=l.loading&&!u,f=u||h||{},x=f.unterminated,m=f.terminated,j=f.workspaceOrError,g=s.useMemo((function(){var e={},n=Date.now();return[].concat((0,Fe.Z)("Runs"===(null===x||void 0===x?void 0:x.__typename)?x.results:[]),(0,Fe.Z)("Runs"===(null===m||void 0===m?void 0:m.__typename)?m.results:[])).forEach((function(r){if(r.startTime&&r.repositoryOrigin&&(0,Vn.a)({start:t,end:i},{start:1e3*r.startTime,end:r.endTime?1e3*r.endTime:n})){var o=qn({name:r.repositoryOrigin.repositoryName,location:r.repositoryOrigin.repositoryLocationName},r.pipelineName);e[o]=[].concat((0,Fe.Z)(e[o]||[]),[{id:r.id,status:r.status,startTime:1e3*r.startTime,endTime:r.endTime?1e3*r.endTime:n}])}})),e}),[i,x,m,t]),v=s.useMemo((function(){if(!j||"Workspace"!==j.__typename)return[];var e,n=[],r=(0,ge.Z)(j.locationEntries);try{var o=function(){var r,o=e.value;if("WorkspaceLocationEntry"!==o.__typename||"RepositoryLocation"!==(null===(r=o.locationOrLoadError)||void 0===r?void 0:r.__typename))return"continue";var s,a=Date.now(),l=(0,ge.Z)(o.locationOrLoadError.repositories);try{for(l.s();!(s=l.n()).done;){var c,d=s.value,u=(0,Ce.kQ)(d.name,o.locationOrLoadError.name),h=(0,ge.Z)(d.pipelines);try{var p=function(){var e,r=c.value,o=(d.schedules||[]).filter((function(e){return e.pipelineName===r.name})),s=[],l=(0,ge.Z)(o);try{var h=function(){var n=e.value;n.scheduleState.status===X.ynu.RUNNING&&n.futureTicks.results.forEach((function(e){var r=e.timestamp,o=1e3*r;o>a&&(0,Vn.a)({start:t,end:i},{start:o,end:o})&&s.push({id:"".concat(n.pipelineName,"-future-run-").concat(r),status:"SCHEDULED",startTime:o,endTime:o+5e3})}))};for(l.s();!(e=l.n()).done;)h()}catch(w){l.e(w)}finally{l.f()}var p=(0,ye.pv)(r.name),f=qn(u,r.name),x=p?"Ad hoc materializations":r.name,m=g[f]||[];if(!s.length&&!m.length)return"continue";var j=[].concat((0,Fe.Z)(m),s);if(p){var v,y=n.find((function(e){return"asset"===e.jobType}));if(y)return(v=y.runs).push.apply(v,(0,Fe.Z)(j)),"continue"}n.push({key:f,jobName:x,jobType:p?"asset":"job",repoAddress:u,path:(0,Un.jT)({repoName:u.name,repoLocation:u.location,pipelineName:r.name,isJob:r.isJob}),runs:[].concat((0,Fe.Z)(m),s)})};for(h.s();!(c=h.n()).done;)p()}catch(f){h.e(f)}finally{h.f()}}}catch(f){l.e(f)}finally{l.f()}};for(r.s();!(e=r.n()).done;)o()}catch(a){r.e(a)}finally{r.f()}var s=n.reduce((function(e,n){var r=n.runs.map((function(e){return e.startTime}));return(0,c.Z)((0,c.Z)({},e),{},(0,Zn.Z)({},n.key,Math.min.apply(Math,(0,Fe.Z)(r))))}),{});return n.sort((function(e,n){return s[e.key]-s[n.key]}))}),[j,g,t,i]);return s.useMemo((function(){return{jobs:v,initialLoading:p,queryData:l}}),[p,v,l])}(P),F=R.jobs,Z=R.initialLoading,_=R.queryData,U=(0,y.C4)(_,y.dT),B=s.useMemo((function(){var e=A.toLocaleLowerCase().trim(),n=r.flatMap((function(n){var r=(0,Ce.kQ)(n.repository.name,n.repositoryLocation.name);return n.repository.pipelines.filter((function(n){return n.name.toLocaleLowerCase().includes(e)})).map((function(e){return qn(r,e.name)}))}));return new Set(n)}),[r,A]),D=s.useMemo((function(){return F.filter((function(e){var n=e.key;return B.has(n)}))}),[F,B]);return(0,E.jsxs)(x.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,E.jsx)(p.m,{title:(0,E.jsx)(f.X6,{children:"Overview"}),tabs:(0,E.jsx)(T,{tab:"timeline",refreshState:U})}),(0,E.jsxs)(x.x,{padding:{horizontal:24,vertical:16},flex:{alignItems:"center",justifyContent:"space-between"},children:[(0,E.jsxs)(x.x,{flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[n.length>1&&(0,E.jsx)(be.C,{}),(0,E.jsx)(ve.oi,{icon:"search",value:A,onChange:function(e){return O(e.target.value)},placeholder:"Filter by job name\u2026",style:{width:"200px"}})]}),(0,E.jsxs)(x.x,{flex:{direction:"row",gap:16,alignItems:"center"},children:[(0,E.jsx)(Pn.h,{activeItems:new Set([o]),buttons:[{id:"1",label:"1hr"},{id:"6",label:"6hr"},{id:"12",label:"12hr"},{id:"24",label:"24hr"}],onClick:function(e){return a(e)}}),(0,E.jsxs)(x.x,{flex:{direction:"row",gap:4,alignItems:"center"},children:[(0,E.jsx)(W.zx,{onClick:N,children:"\u2190"}),(0,E.jsx)(W.zx,{onClick:L,children:"Now"}),(0,E.jsx)(W.zx,{onClick:I,children:"\u2192"})]})]})]}),(0,E.jsx)(Rn.S,{region:"timeline",children:(0,E.jsx)(Fn.q,{loading:Z,range:P,jobs:D})})]})},Jn=function(){return(0,E.jsxs)(a.rs,{children:[(0,E.jsx)(a.AW,{path:"/overview/timeline",children:(0,E.jsx)(Gn,{})}),(0,E.jsx)(a.AW,{path:"/overview/jobs",children:(0,E.jsx)(_e,{})}),(0,E.jsx)(a.AW,{path:"/overview/schedules",children:(0,E.jsx)(gn,{})}),(0,E.jsx)(a.AW,{path:"/overview/sensors",children:(0,E.jsx)(Tn,{})}),(0,E.jsx)(a.AW,{path:"/overview/backfills/:backfillId",children:(0,E.jsx)(re,{})}),(0,E.jsx)(a.AW,{path:"/overview/backfills",exact:!0,children:(0,E.jsx)(P,{})}),(0,E.jsx)(a.AW,{path:"/overview/resources",children:(0,E.jsx)(We,{})}),(0,E.jsx)(a.AW,{path:"*",render:function(){return(0,E.jsx)(a.l_,{to:"/overview/timeline"})}})]})},Kn=Jn},25298:function(e,n,r){r.d(n,{V:function(){return i},J:function(){return o}});var t=new Intl.NumberFormat(navigator.language,{compactDisplay:"short",notation:"compact"}),i=new Intl.NumberFormat(navigator.language,{}),o=function(e){return t.format(e)}}}]);
//# sourceMappingURL=4.15c24145.chunk.js.map